
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>10. Real-world problems and additional topics &#8212; Introduction to Statistical Data Analysis and Visualization with Python Day 2</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.37f24b989f4638ff9c27c22dc7559d4f.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Matplotlib: data content" href="11-Matplotlib_content.html" />
    <link rel="prev" title="9. Combining and grouping DataFrames" href="09-Pandas_combine.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Introduction to Statistical Data Analysis and Visualization with Python Day 2</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Readme.html">
   Introduction to Statistical Data Analysis and Visualization with Python
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="00-Introduction.html">
   00. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01-Intro_Pandas_Numpy.html">
   1. Pandas and Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-Numpy_arrays.html">
   2. Numpy arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-Numpy_maths.html">
   3. Numpy for mathematics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04-Numpy_indexing.html">
   4. Numpy indexing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05-Minimal_plotting.html">
   5. Minimal plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06-Back_to_Pandas.html">
   6. Back to Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07-Operate_on_DataFrames.html">
   7. Operating on DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08-DataFrame_indexing.html">
   8. DataFrame indexing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09-Pandas_combine.html">
   9. Combining and grouping DataFrames
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   10. Real-world problems and additional topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11-Matplotlib_content.html">
   Matplotlib: data content
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12-Matplotlib_non_data_elements.html">
   12. Matplotlib: adjusting non-data elements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-Matplotlib_statistics.html">
   13. Matplotlib statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-Matplotlib_statistics.html#binning-with-standard-deviation-bars">
   Binning with standard deviation bars
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-Matplotlib_statistics.html#adding-error-bars">
   Adding error bars
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-Matplotlib_statistics.html#box-plots">
   Box plots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-Matplotlib_statistics.html#violin-plot">
   Violin plot
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-Matplotlib_statistics.html#exercise">
   Exercise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14-Matplotlib_annotations.html">
   14. Legends and Annotations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15-Seaborn_concept.html">
   15. Seaborn introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16-Seaborn_distributions_relations.html">
   16. Seaborn: distributions and relations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17-Seaborn_regression.html">
   17. Regression
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/10-Real_world.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/10-Real_world.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#absent-values">
   Absent values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#replacing-bad-values">
   Replacing
   <em>
    bad
   </em>
   values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dealing-with-time">
   Dealing with time
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="real-world-problems-and-additional-topics">
<h1>10. Real-world problems and additional topics<a class="headerlink" href="#real-world-problems-and-additional-topics" title="Permalink to this headline">¶</a></h1>
<p>During this course we have either used simple demo examples designed to illustrate specific aspects of Pandas, or real-world data where we ignored some of the potentials problems. In this notebook, we address a few of the common problems that you might encounter. We also address some other common situations that you might encounter such as dealing with specific formats like dates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="absent-values">
<h2>Absent values<a class="headerlink" href="#absent-values" title="Permalink to this headline">¶</a></h2>
<p>Very often, data that you need are imperfect: they migth have missing values or some values might be “incorrect”, e.g. in a column supposed to contain numbers you suddently encounter text. Pandas offers many ways to fix these problems.</p>
<p>Let’s once again import our penguin data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/allisonhorst/palmerpenguins/master/inst/extdata/penguins.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(344, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here we see that some values are missing and filled with <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. As we have seen previously, Pandas is capable of handling <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values e.g. when calculating statistics. But sometimes we want to remove those values. We can for example use <code class="docutils literal notranslate"><span class="pre">.dropna()</span></code> for this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">penguins_clean</span> <span class="o">=</span> <span class="n">penguins</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">penguins_clean</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.3</td>
      <td>20.6</td>
      <td>190.0</td>
      <td>3650.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We see that for example the index 3 has disappeared. <code class="docutils literal notranslate"><span class="pre">.dropna()</span></code> drops each line that has an <code class="docutils literal notranslate"><span class="pre">NaN</span></code> in any column.</p>
<p>You can also be more precise and check for <code class="docutils literal notranslate"><span class="pre">NaN</span></code> in a given column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="o">.</span><span class="n">bill_length_mm</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      False
1      False
2      False
3       True
4      False
       ...  
339    False
340    False
341    False
342    False
343    False
Name: bill_length_mm, Length: 344, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>Using indexing, we can now remove <strong>only lines</strong> which have <code class="docutils literal notranslate"><span class="pre">NA</span></code> in that column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">penguins_clean2</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="o">~</span><span class="n">penguins</span><span class="o">.</span><span class="n">bill_length_mm</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">penguins_clean2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.3</td>
      <td>20.6</td>
      <td>190.0</td>
      <td>3650.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="replacing-bad-values">
<h2>Replacing <em>bad</em> values<a class="headerlink" href="#replacing-bad-values" title="Permalink to this headline">¶</a></h2>
<p>When importing a table, Pandas is capable of recognizing specific values as being <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. For example the text NaN or missing values are turned in “offficial” <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. But often there are just mistakes in the table. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">composer_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/guiwitz/NumpyPandas_course/blob/master/Data/composers.xlsx?raw=true&#39;</span>
<span class="n">composers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">composer_url</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">composers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composer</th>
      <th>birth</th>
      <th>death</th>
      <th>city</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mahler</td>
      <td>1860.0</td>
      <td>1911</td>
      <td>Kaliste</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Beethoven</td>
      <td>1770.0</td>
      <td>1827</td>
      <td>Bonn</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Puccini</td>
      <td>1858.0</td>
      <td>1924</td>
      <td>Lucques</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Shostakovich</td>
      <td>1906.0</td>
      <td>1975</td>
      <td>Saint-Petersburg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sibelius</td>
      <td>10.0</td>
      <td>unknown</td>
      <td>unknown</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Haydn</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Röhrau</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here we see that we have both <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values and other “bad” values in the form of <code class="docutils literal notranslate"><span class="pre">uknown</span></code> text. This is a problem because now the columns containing that text are not “number-columns” anymore and for example we can’t do operations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">composers</span><span class="p">[</span><span class="s1">&#39;death&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="ne">AttributeError</span>: &#39;int&#39; object has no attribute &#39;log&#39;

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-12-e52f6d019ecf&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">composers</span><span class="p">[</span><span class="s1">&#39;death&#39;</span><span class="p">])</span>

<span class="nn">/usr/local/lib/python3.7/dist-packages/pandas/core/series.py</span> in <span class="ni">__array_ufunc__</span><span class="nt">(self, ufunc, method, *inputs, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">724</span> 
<span class="g g-Whitespace">    </span><span class="mi">725</span>         <span class="n">inputs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">extract_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">extract_numpy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">726</span>         <span class="n">result</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">)(</span><span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">727</span> 
<span class="g g-Whitespace">    </span><span class="mi">728</span>         <span class="n">name</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>

<span class="ne">TypeError</span>: loop of ufunc does not support argument 0 of type int which has no callable log method
</pre></div>
</div>
</div>
</div>
<p>We therefore have first to clean-up the table. One solution is to replace all bade values. For that we can use <code class="docutils literal notranslate"><span class="pre">.replace</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">composers_clean</span> <span class="o">=</span> <span class="n">composers</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">composers_clean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composer</th>
      <th>birth</th>
      <th>death</th>
      <th>city</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mahler</td>
      <td>1860.0</td>
      <td>1911.0</td>
      <td>Kaliste</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Beethoven</td>
      <td>1770.0</td>
      <td>1827.0</td>
      <td>Bonn</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Puccini</td>
      <td>1858.0</td>
      <td>1924.0</td>
      <td>Lucques</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Shostakovich</td>
      <td>1906.0</td>
      <td>1975.0</td>
      <td>Saint-Petersburg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sibelius</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Haydn</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Röhrau</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">composers_clean</span><span class="p">[</span><span class="s1">&#39;death&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    7.555382
1    7.510431
2    7.562162
3    7.588324
4         NaN
5         NaN
Name: death, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Alternatively we can fix this problem at import time as well because we might have a lsit of all “bad entries”. For that we can use the option</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">composer_url</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unknown&#39;</span><span class="p">],</span> <span class="n">sheet_name</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composer</th>
      <th>birth</th>
      <th>death</th>
      <th>city</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mahler</td>
      <td>1860.0</td>
      <td>1911.0</td>
      <td>Kaliste</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Beethoven</td>
      <td>1770.0</td>
      <td>1827.0</td>
      <td>Bonn</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Puccini</td>
      <td>1858.0</td>
      <td>1924.0</td>
      <td>Lucques</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Shostakovich</td>
      <td>1906.0</td>
      <td>1975.0</td>
      <td>Saint-Petersburg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sibelius</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Haydn</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Röhrau</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="dealing-with-time">
<h2>Dealing with time<a class="headerlink" href="#dealing-with-time" title="Permalink to this headline">¶</a></h2>
<p>Pandas offers many possibilities to help dealing with data containing time, e.g. to calculate how many days have passed between two dates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">composers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">composer_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">composers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composer</th>
      <th>birth</th>
      <th>death</th>
      <th>city</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mahler</td>
      <td>1860</td>
      <td>1911</td>
      <td>Kaliste</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Beethoven</td>
      <td>1770</td>
      <td>1827</td>
      <td>Bonn</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Puccini</td>
      <td>1858</td>
      <td>1924</td>
      <td>Lucques</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Shostakovich</td>
      <td>1906</td>
      <td>1975</td>
      <td>Saint-Petersburg</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We transform now the <code class="docutils literal notranslate"><span class="pre">birth</span></code> and <code class="docutils literal notranslate"><span class="pre">death</span></code> columns into <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects using <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> and by specifying a format, here just a year <code class="docutils literal notranslate"><span class="pre">%Y</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">composers</span><span class="p">[</span><span class="s1">&#39;birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">composers</span><span class="p">[</span><span class="s1">&#39;birth&#39;</span><span class="p">],</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;%Y&#39;</span><span class="p">)</span>
<span class="n">composers</span><span class="p">[</span><span class="s1">&#39;death&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">composers</span><span class="p">[</span><span class="s1">&#39;death&#39;</span><span class="p">],</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;%Y&#39;</span><span class="p">)</span>
<span class="n">composers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composer</th>
      <th>birth</th>
      <th>death</th>
      <th>city</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mahler</td>
      <td>1860-01-01</td>
      <td>1911-01-01</td>
      <td>Kaliste</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Beethoven</td>
      <td>1770-01-01</td>
      <td>1827-01-01</td>
      <td>Bonn</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Puccini</td>
      <td>1858-01-01</td>
      <td>1924-01-01</td>
      <td>Lucques</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Shostakovich</td>
      <td>1906-01-01</td>
      <td>1975-01-01</td>
      <td>Saint-Petersburg</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can see that the year has been turned into an actual date (using 1st January as default). We create now an age column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">composers</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">composers</span><span class="o">.</span><span class="n">death</span><span class="o">-</span> <span class="n">composers</span><span class="o">.</span><span class="n">birth</span><span class="p">)</span>
<span class="n">composers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composer</th>
      <th>birth</th>
      <th>death</th>
      <th>city</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mahler</td>
      <td>1860-01-01</td>
      <td>1911-01-01</td>
      <td>Kaliste</td>
      <td>18627 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Beethoven</td>
      <td>1770-01-01</td>
      <td>1827-01-01</td>
      <td>Bonn</td>
      <td>20818 days</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Puccini</td>
      <td>1858-01-01</td>
      <td>1924-01-01</td>
      <td>Lucques</td>
      <td>24105 days</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Shostakovich</td>
      <td>1906-01-01</td>
      <td>1975-01-01</td>
      <td>Saint-Petersburg</td>
      <td>25202 days</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Since the columns are datetime objects, Pandas know that it should actually compute difference in dates and by defaults gives days. Here the computation is trivial, but if you deal with formats such as <code class="docutils literal notranslate"><span class="pre">HH:MM:SS</span></code> this is very useful.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="09-Pandas_combine.html" title="previous page">9. Combining and grouping DataFrames</a>
    <a class='right-next' id="next-link" href="11-Matplotlib_content.html" title="next page">Matplotlib: data content</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Guillaume Witz<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>